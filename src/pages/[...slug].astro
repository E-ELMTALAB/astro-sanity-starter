---
import type { Page } from 'types';
import Layout from '@layouts/Layout.astro';
import TelegramShopHome from '@components/TelegramShopHome.tsx';
import { fetchData, getPageById } from '@data/page';

export async function getStaticPaths() {
    const data = await fetchData();
    return data.map((page: Page) => {
        const slug = page.slug.current === '/' ? undefined : page.slug.current;
        return {
            params: { slug },
            props: { id: page._id }
        };
    });
}

const { id } = Astro.props;
const pages = await getPageById(id);
const page: Page = pages.length ? pages[0] : null;

const { _id, title, metaTitle, metaDescription, socialImage } = page || {};
---
---

{
    page && (
        <Layout title={metaTitle ?? title} description={metaDescription} image={socialImage}>
            <div data-sb-object-id={_id}>
                <TelegramShopHome client:load />
            </div>
        </Layout>
    )
}
